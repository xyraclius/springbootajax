<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Spring Boot AJAX</title>
    <link rel="stylesheet" th:href="@{webjars/bootstrap/4.3.1/css/bootstrap.min.css}"
          type="text/css"/>
</head>
<body>
<div class="col-lg-10">
    <button class="btn btn-primary" id="btnCreateNew" style="margin-bottom: 10px"
            title="Create New Mahasiswa" type="button">
        Create New
    </button>

    <table class="table table-bordered table-striped table-hover" id="mahasiswaTable">
        <thead>
        <tr>
            <th>NIM</th>
            <th>Nama</th>
            <th>Jurusan</th>
            <th>Action</th>
        </tr>
        <tr th:each="mhs : ${mahasiswaList}">
            <td th:text="${mhs.nim}"></td>
            <td th:text="${mhs.nama}"></td>
            <td th:text="${mhs.jurusan}"></td>
            <td>
                <button class="btn btn-success" id="btnEdit" th:value="${mhs.nim}">Edit</button>
            </td>
        </tr>
        </thead>
    </table>
</div>

<div class="modal fade" id="modal-input">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="modalTitle"></h4>
            </div>
            <div class="modal-body"></div>
        </div>
    </div>
</div>

<script th:src="@{webjars/jquery/3.4.0/jquery.min.js}"
        type="text/javascript"></script>
<script th:src="@{webjars/bootstrap/4.3.1/js/bootstrap.min.js}"
        type="text/javascript"></script>
<script th:inline="javascript">
    $(document).ready(function () {
        $('#btnCreateNew').on('click', function () {
            $.ajax({
                url: 'mahasiswa/create',
                type: 'get',
                dataType: 'html',
                success: function (data) {
                    $("#modalTitle").text("Create New Mahasiswa");
                    $("#modal-input").find(".modal-body").html(data);
                    $("#modal-input").modal('show');
                }
            });
        });

        $('#mahasiswaTable').on('click', '#btnEdit', function () {
            var nimValue = $(this).val();
            $.ajax({
                url: 'mahasiswa/edit',
                type: 'get',
                data: {nim: nimValue},
                dataType: 'html',
                success: function (data) {
                    $("#modalTitle").text("Edit Mahasiswa");
                    $("#modal-input").find(".modal-body").html(data);
                    $("#modal-input").modal('show');
                }
            });
        });
    });
</script>
</body>
</html>